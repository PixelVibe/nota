{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/global/Storage.js","webpack:///./src/global/index.js"],"names":["Storage","retrieveNotesForUrl","id","index","res","browser","storage","local","get","notes","error","console","log","message","createNote","data","note","dbObject","doc","editingInfo","isEditing","splice","set","deleteNote","noteInfo","bjExtensionDb","runtime","onMessage","addListener","type","docId","noteIndex","createNewNote","body","contextMenus","onClicked","OnClickData","menuItemId","pageUrl","text","selectionText","tags","meta","create","title","i18n","getMessage","contexts"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;AClFA;AAAA;AAAe,MAAMA,OAAN,CAAc;AAC3B;AACA,QAAMC,mBAAN,CAA0BC,EAA1B,EAA8BC,KAAK,GAAG,CAAC,CAAvC,EAA0C;AACxC,QAAI;AACF,YAAMC,GAAG,GAAG,MAAMC,OAAO,CAACC,OAAR,CAAgBC,KAAhB,CAAsBC,GAAtB,CAA0BN,EAA1B,CAAlB;;AAEA,UAAIC,KAAK,GAAG,CAAC,CAAb,EAAgB;AACd,eAAOC,GAAG,CAACF,EAAD,CAAH,CAAQO,KAAR,CAAcN,KAAd,CAAP;AACD,OAFD,MAEO;AACL,eAAOC,GAAG,CAACF,EAAD,CAAV;AACD;AACF,KARD,CAQE,OAAOQ,KAAP,EAAc;AACdC,aAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCF,KAAK,CAACG,OAA1C;AACD;AACF,GAd0B,CAgB3B;;;AACA,QAAMC,UAAN,CAAiB;AAAEZ,MAAF;AAAMa;AAAN,MAAeC,IAAhC,EAAsC;AACpC,UAAMC,QAAQ,GAAG,MAAM,KAAKhB,mBAAL,CAAyBC,EAAzB,CAAvB;AACA,QAAIgB,GAAG,GAAG,EAAV;;AACA,QAAI,CAACD,QAAL,EAAe;AACbC,SAAG,CAAChB,EAAD,CAAH,GAAUa,IAAV;AACD,KAFD,MAEO;AACLG,SAAG,CAAChB,EAAD,CAAH,GAAUe,QAAV,CADK,CAEL;;AACA,UAAIF,IAAI,CAACI,WAAL,CAAiBC,SAArB,EAAgC;AAC9BF,WAAG,CAAChB,EAAD,CAAH,CAAQO,KAAR,CAAcY,MAAd,CAAqBN,IAAI,CAACI,WAAL,CAAiBhB,KAAtC,EAA6C,CAA7C,EAAgDY,IAAI,CAACN,KAAL,CAAW,CAAX,CAAhD;AACD,OAFD,MAEO;AACLS,WAAG,CAAChB,EAAD,CAAH,CAAQO,KAAR,GAAgB,CAACM,IAAI,CAACN,KAAL,CAAW,CAAX,CAAD,EAAgB,GAAGQ,QAAQ,CAACR,KAA5B,CAAhB;AACD;AACF,KAbmC,CAepC;;;AACAJ,WAAO,CAACC,OAAR,CAAgBC,KAAhB,CAAsBe,GAAtB,CAA0BJ,GAA1B;AACD,GAlC0B,CAoC3B;;;AACA,QAAMK,UAAN,CAAiB;AAACrB,MAAD;AAAKC;AAAL,MAAcqB,QAA/B,EAAyC;AACvC,QAAI;AACF,YAAMP,QAAQ,GAAG,MAAM,KAAKhB,mBAAL,CAAyBC,EAAzB,CAAvB;AACA,UAAIgB,GAAG,GAAG,EAAV;AACAA,SAAG,CAAChB,EAAD,CAAH,GAAUe,QAAV;AACAC,SAAG,CAAChB,EAAD,CAAH,CAAQO,KAAR,CAAcY,MAAd,CAAqBlB,KAArB,EAA4B,CAA5B;AACAE,aAAO,CAACC,OAAR,CAAgBC,KAAhB,CAAsBe,GAAtB,CAA0BJ,GAA1B;AACD,KAND,CAME,OAAOR,KAAP,EAAc;AACdC,aAAO,CAACC,GAAR,CAAY,oDAAZ,EAAkEF,KAAlE;AACD;AACF;;AA/C0B,C;;;;;;;;;;;;ACA7B;AAAA;AAAA;AAEA,MAAMe,aAAa,GAAG,IAAIzB,gDAAJ,EAAtB;AAEAK,OAAO,CACJqB,OADH,CAEGC,SAFH,CAGGC,WAHH,CAGgBf,OAAD,IAAa;AACxB,UAAQA,OAAO,CAACgB,IAAhB;AACE,SAAK,gCAAL;AAAuC;AACrC,YAAI;AACF,iBAAOJ,aAAa,CAACxB,mBAAd,CAAkCY,OAAO,CAACiB,KAA1C,EAAiDjB,OAAO,CAACkB,SAAzD,CAAP;AACD,SAFD,CAEE,OAAOrB,KAAP,EAAc;AACdC,iBAAO,CAACC,GAAR,CAAY,6BAAZ,EAA2CF,KAA3C;AACD;;AACD;AACD;AAED;;AACA,SAAK,UAAL;AAAiB;AACfsB,qBAAa,CAACnB,OAAO,CAACoB,IAAT,CAAb;AACA;AACD;;AAED,SAAK,aAAL;AAAoB;AAClBV,kBAAU,CAACV,OAAO,CAACoB,IAAT,CAAV;AACA;AACD;AAnBH;AAqBD,CAzBH,E,CA2BA;;AACA5B,OAAO,CAAC6B,YAAR,CAAqBC,SAArB,CAA+BP,WAA/B,CAA4CQ,WAAD,IAAiB;AAC1D,MAAIP,IAAJ;;AACA,UAAOO,WAAW,CAACC,UAAnB;AACE,SAAK,uBAAL;AAA8B;AAC5BR,YAAI,GAAG,aAAP;AACA;AACD;;AACD,SAAK,kBAAL;AAAyB;AACvBA,YAAI,GAAG,QAAP;AACA;AACD;;AACD,SAAK,iBAAL;AAAwB;AACtBA,YAAI,GAAG,OAAP;AACA;AACD;AAZH;;AAcAG,eAAa,CAAC;AACZ9B,MAAE,EAAEkC,WAAW,CAACE,OADJ;AAEZvB,QAAI,EAAE;AACJI,iBAAW,EAAE;AACXC,iBAAS,EAAE;AADA,OADT;AAIJX,WAAK,EAAE,CAAC;AACN8B,YAAI,EAAEH,WAAW,CAACI,aADZ;AAENX,YAFM;AAEAY,YAAI,EAAE;AAFN,OAAD,CAJH;AAQJC,UAAI,EAAE;AARF;AAFM,GAAD,CAAb,CAhB0D,CA8B1D;AACA;AACA;AACA;AACA;AACA;AAED,CArCD;AAuCArC,OAAO,CAAC6B,YAAR,CAAqBS,MAArB,CAA4B;AAC1BzC,IAAE,EAAE,uBADsB;AAE1B2B,MAAI,EAAE,QAFoB;AAG1Be,OAAK,EAAEvC,OAAO,CAACwC,IAAR,CAAaC,UAAb,CAAwB,qCAAxB,CAHmB;AAI1BC,UAAQ,EAAE,CAAC,WAAD;AAJgB,CAA5B;AAOA1C,OAAO,CAAC6B,YAAR,CAAqBS,MAArB,CAA4B;AAC1BzC,IAAE,EAAE,kBADsB;AAE1B2B,MAAI,EAAE,QAFoB;AAG1Be,OAAK,EAAEvC,OAAO,CAACwC,IAAR,CAAaC,UAAb,CAAwB,gCAAxB,CAHmB;AAI1BC,UAAQ,EAAE,CAAC,WAAD;AAJgB,CAA5B;AAOA1C,OAAO,CAAC6B,YAAR,CAAqBS,MAArB,CAA4B;AAC1BzC,IAAE,EAAE,iBADsB;AAE1B2B,MAAI,EAAE,QAFoB;AAG1Be,OAAK,EAAEvC,OAAO,CAACwC,IAAR,CAAaC,UAAb,CAAwB,+BAAxB,CAHmB;AAI1BC,UAAQ,EAAE,CAAC,WAAD;AAJgB,CAA5B,E,CAOA;;AACA,SAASf,aAAT,CAAuBhB,IAAvB,EAA6B;AAC3BS,eAAa,CAACX,UAAd,CAAyBE,IAAzB;AACD;;AAED,SAASO,UAAT,CAAoBP,IAApB,EAA0B;AACxBS,eAAa,CAACF,UAAd,CAAyBP,IAAzB;AACD,C","file":"global/index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/global/index.js\");\n","export default class Storage {\n  // Retrieve single\n  async retrieveNotesForUrl(id, index = -1) {\n    try {\n      const res = await browser.storage.local.get(id);\n\n      if (index > -1) {\n        return res[id].notes[index];\n      } else {\n        return res[id];\n      }\n    } catch (error) {\n      console.log(\"something went wrong\", error.message);\n    }\n  }\n\n  // Put single\n  async createNote({ id, data } = note) {\n    const dbObject = await this.retrieveNotesForUrl(id);\n    let doc = {};\n    if (!dbObject) {\n      doc[id] = data;\n    } else {\n      doc[id] = dbObject;\n      // Check if the document is in edit mode\n      if (data.editingInfo.isEditing) {\n        doc[id].notes.splice(data.editingInfo.index, 1, data.notes[0]);\n      } else {\n        doc[id].notes = [data.notes[0], ...dbObject.notes];\n      }\n    }\n\n    // Store the new/updated document\n    browser.storage.local.set(doc);\n  }\n\n  // Delete notes\n  async deleteNote({id, index} = noteInfo) {\n    try {\n      const dbObject = await this.retrieveNotesForUrl(id);\n      let doc = {};\n      doc[id] = dbObject;\n      doc[id].notes.splice(index, 1);\n      browser.storage.local.set(doc);\n    } catch (error) {\n      console.log(\"there was an error while trying to delete the note\", error);\n    }\n  }\n}\n","import Storage from './Storage';\n\nconst bjExtensionDb = new Storage();\n\nbrowser\n  .runtime\n  .onMessage\n  .addListener((message) => {\n    switch (message.type) {\n      case 'fetch-notes-for-active-tab-url': {\n        try {\n          return bjExtensionDb.retrieveNotesForUrl(message.docId, message.noteIndex);\n        } catch (error) {\n          console.log('Error while fetching notes ', error);\n        }\n        break;\n      }\n\n      // New notes coming from the popup action and not from selected text\n      case 'new-note': {\n        createNewNote(message.body);\n        break;\n      }\n\n      case 'delete-note': {\n        deleteNote(message.body);\n        break;\n      }\n    }\n  });\n\n// Context menu\nbrowser.contextMenus.onClicked.addListener((OnClickData) => {\n  let type;\n  switch(OnClickData.menuItemId) {\n    case 'highlight-interesting': {\n      type = 'interesting';\n      break;\n    }\n    case 'highlight-review': {\n      type = 'review';\n      break;\n    }\n    case 'highlight-other': {\n      type = 'other';\n      break;\n    }\n  }\n  createNewNote({\n    id: OnClickData.pageUrl,\n    data: {\n      editingInfo: {\n        isEditing: false\n      },\n      notes: [{\n        text: OnClickData.selectionText,\n        type, tags: []\n      }],\n      meta: []\n    }\n  });\n\n  // browser.tabs.executeScript({\n  //   file: \"./../contentScripts/index.js\",\n  // })\n  // .catch((error) => {\n  //   console.log('There was an error while injecting the content script', error);\n  // })\n\n});\n\nbrowser.contextMenus.create({\n  id: \"highlight-interesting\",\n  type: \"normal\",\n  title: browser.i18n.getMessage(\"contextMenuItemHighlightInteresting\"),\n  contexts: [\"selection\"],\n});\n\nbrowser.contextMenus.create({\n  id: \"highlight-review\",\n  type: \"normal\",\n  title: browser.i18n.getMessage(\"contextMenuItemHighlightReview\"),\n  contexts: [\"selection\"],\n});\n\nbrowser.contextMenus.create({\n  id: \"highlight-other\",\n  type: \"normal\",\n  title: browser.i18n.getMessage(\"contextMenuItemHighlightOther\"),\n  contexts: [\"selection\"],\n});\n\n// Functions to handle events\nfunction createNewNote(note) {\n  bjExtensionDb.createNote(note);\n}\n\nfunction deleteNote(note) {\n  bjExtensionDb.deleteNote(note);\n}"],"sourceRoot":""}